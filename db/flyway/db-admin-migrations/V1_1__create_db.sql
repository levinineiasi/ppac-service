CREATE TABLE IF NOT EXISTS CODES
(
    ID        VARCHAR(36) PRIMARY KEY,
    VALUE     INTEGER UNIQUE CHECK (VALUE BETWEEN 100000 AND 999999),
    CODE_TYPE VARCHAR(12) CHECK (CODE_TYPE IN ('ADMIN_CODE', 'COMPANY_CODE'))
) CHARACTER SET 'latin1';

CREATE TABLE IF NOT EXISTS COMPANIES
(
    ID          VARCHAR(36) PRIMARY KEY,
    NAME        VARCHAR(150) NOT NULL UNIQUE CHECK (LENGTH(NAME) >= 2),
    CODE_ID     VARCHAR(36) NOT NULL ,
    DESCRIPTION VARCHAR(3000) DEFAULT NULL UNIQUE CHECK (LENGTH(DESCRIPTION) >=  20),
    EMAIL       VARCHAR(50)  DEFAULT NULL UNIQUE CHECK (LENGTH(EMAIL) >= 5),
    LOGO        LONGBLOB        DEFAULT NULL,
    FOREIGN KEY (CODE_ID) REFERENCES CODES (ID) ON DELETE CASCADE ON UPDATE CASCADE
) CHARACTER SET 'latin1';


CREATE TABLE IF NOT EXISTS OPENINGS
(
    ID                            VARCHAR(36) PRIMARY KEY,
    COMPANY_ID                    VARCHAR(36) NOT NULL,
    HAS_TECHNICAL_INTERVIEW       BOOLEAN NOT NULL,
    HAS_TECHNICAL_TEST            BOOLEAN NOT NULL,
    PERIOD_COUNT                  INTEGER NOT NULL CHECK (PERIOD_COUNT >= 1 AND PERIOD_COUNT <=50),
    PERIOD_TYPE                   VARCHAR(12) CHECK (PERIOD_TYPE IN ('WEEKS', 'MONTHS')),
    OPEN_POSITIONS                INTEGER NOT NULL CHECK (OPEN_POSITIONS >= 1 AND OPEN_POSITIONS <=50),
    ACCEPT_ON_CLOSING_OPPORTUNITY BOOLEAN NOT NULL,
    SIGN_AGREEMENT                BOOLEAN NOT NULL,
    AVAILABLE                     BOOLEAN NOT NULL,
    TITLE                         VARCHAR(150) CHECK (LENGTH(TITLE) >= 5),
    DESCRIPTION                   VARCHAR(3000) CHECK (LENGTH(DESCRIPTION) >= 20),
    REQUIREMENTS                  VARCHAR(3000),
    RESTRICTIONS                  VARCHAR(3000),
    RECRUITMENT_PROCESS           VARCHAR(3000),
    START_DATE                    DATE,
    VIEWS                         INTEGER NOT NULL CHECK (VIEWS >= 0),
    FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES (ID) ON DELETE CASCADE ON UPDATE CASCADE
) CHARACTER SET 'latin1';

CREATE TABLE IF NOT EXISTS TRAINERS
(
    ID           VARCHAR(36) PRIMARY KEY,
    NAME         VARCHAR(50)  NOT NULL CHECK (LENGTH(NAME) >= 2),
    ROLE         VARCHAR(150) NOT NULL,
    LINKEDIN_URL VARCHAR(100) DEFAULT NULL  CHECK (LENGTH(LINKEDIN_URL) >= 15),
    AVATAR       LONGBLOB DEFAULT NULL
) CHARACTER SET 'latin1';

CREATE TABLE IF NOT EXISTS OPENINGS_TRAINERS
(
    OPENINGENTITY_ID VARCHAR(36) NOT NULL,
    TRAINERS_ID       VARCHAR(36) NOT NULL,
    FOREIGN KEY (OPENINGENTITY_ID) REFERENCES OPENINGS (ID) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (TRAINERS_ID) REFERENCES TRAINERS (ID) ON DELETE CASCADE ON UPDATE CASCADE,
    PRIMARY KEY (OPENINGENTITY_ID, TRAINERS_ID)
) CHARACTER SET 'latin1';

CREATE TABLE IF NOT EXISTS OpeningEntity_keyWords
(
    OPENINGENTITY_ID VARCHAR(36) NOT NULL,
    KEYWORDS         VARCHAR(255) DEFAULT NULL,
    FOREIGN KEY (OPENINGENTITY_ID) REFERENCES OPENINGS (ID) ON DELETE CASCADE ON UPDATE CASCADE,
    PRIMARY KEY (OPENINGENTITY_ID, KEYWORDS)
) CHARACTER SET 'latin1';

CREATE TABLE IF NOT EXISTS OpeningEntity_customKeyWords
(
    OPENINGENTITY_ID VARCHAR(36) NOT NULL,
    CUSTOMKEYWORDS  varchar(255) DEFAULT NULL,
    FOREIGN KEY (OPENINGENTITY_ID) REFERENCES OPENINGS (ID) ON DELETE CASCADE ON UPDATE CASCADE,
    PRIMARY KEY (OPENINGENTITY_ID, CUSTOMKEYWORDS)
) CHARACTER SET 'latin1';
